<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../../../css/font-awesome.min.css">
        <link rel="stylesheet" href="../../../css/bootstrap.css">
        <link rel="stylesheet" href="../../../css/style.css">
        <title>Assignment</title>
    </head>

    <body>
        <!--Navbar-->
        <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top border-bottom">
            
                <a class="navbar-brand" href="../../../index.html">
                    <img src="../../../images/Radixweb.jpg" alt="" class="img-fluid" width="100px" height="100px">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link mx-3 active" href="../../../HTML/index.html">HTML</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../CSS-Practice/index.html">CSS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../BOOTSTRAP/index.html">BOOTSTRAP</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JAVASCRIPT/index.html">JAVASCRIPT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JQUERY/index.html">JQUERY</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../index.html">SQL</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../PROJECTS/index.html">PROJECTS</a>
                    </li>
                </ul>
                
                </div>
            
        </nav>
        </div>


        <div class="wrapper">
            <!-- Sidebar -->
            <nav id="sidebar">
                
                <div class="sidebar-header">
                    <h3>SQL Tasks</h3>
                </div>
                <ul class="list-unstyled components">
                    <li>
                        <a href="#day1Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day1</a>
                        <ul class="collapse list-unstyled" id="day1Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day1/Practice/Practice1.html" class="pl-5">Practice 1</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice2.html" class="pl-5">Practice 2</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice3.html" class="pl-5">Practice 3</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice4.html" class="pl-5">Practice 4</a>
                                    </li>
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day1/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                        <a href="#day2Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day2</a>
                        <ul class="collapse list-unstyled" id="day2Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day2/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day2/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day3Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day3</a>
                        <ul class="collapse list-unstyled" id="day3Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day3/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day3/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day4Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day4</a>
                        <ul class="collapse list-unstyled" id="day4Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day4/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day4/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day5Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day5</a>
                        <ul class="collapse list-unstyled" id="day5Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day5/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day5/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day6Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day6</a>
                        <ul class="collapse list-unstyled" id="day6Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day6/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day6/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day7Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day7</a>
                        <ul class="collapse list-unstyled" id="day7Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day8Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day8</a>
                        <ul class="collapse list-unstyled" id="day8Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day8/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day8/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    <li>
                                        <a href="../../Day8/Assignment/AssignmentQnA.html" class="pl-5">SQL MTA QnA</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
        
            </nav>
            <!-- Page Content -->
            <div id="content" class="w-100">
        
                <nav class="navbar navbar-expand-lg navbar-light bg-white">
                    <div class="container-fluid">
        
                        <button type="button" id="sidebarCollapse" class="btn btn-primary" onclick="return myFunc()">
                            <i class="fa fa-bars fa-align-left"></i>
                            
                        </button>
                    </div>
                </nav>

                <div class="m-3">
                    <h4>Assignment Tasks</h4>
                    <pre>
                        USE Day2DB

                        --DAY4 TASKS

                        SELECT * FROM OldEmployees

                        Q 1. Write a query to rank employees based on their salary for a month
                        Ans.
                        WITH EmpRank (EmpId, Fname, Lname, EmpSalary, EmplRank)
                        AS
                        (
                            SELECT EmployeeID, FirstName, LastName, Salary, DENSE_RANK() OVER (ORDER BY Salary) 'DenseRank'
                            FROM Employees
                        )
                        SELECT * FROM EmpRank;
                            
                        Q 2. Select 4th Highest salary from employee table using ranking function
                        Ans.
                        SELECT * FROM 
                        (SELECT EmployeeID, FirstName, LastName, Salary, DENSE_RANK() OVER (ORDER BY Salary DESC) 'DenseRank' FROM OldEmployees) AS RankTbl
                        WHERE DenseRank=4

                        Q 3. Get department, total salary with respect to a department from employee table.
                        Ans.
                        WITH DeptSalary (DeptId, EmpSalary)
                        AS
                        (
                            SELECT DepartmentID, Salary
                            FROM OldEmployees
                        )
                        SELECT DeptId, SUM(EmpSalary) AS 'TotalSalary' FROM DeptSalary GROUP BY DeptId;

                        Q 4. Get department, total salary with respect to a department from employee table order by total salary descending
                        Ans.
                        WITH DeptSalary (DeptId, EmpSalary)
                        AS
                        (
                            SELECT DepartmentID, Salary
                            FROM OldEmployees
                        )
                        SELECT DeptId, SUM(EmpSalary) AS 'TotalSalary'
                        FROM DeptSalary
                        GROUP BY DeptId
                        ORDER BY 'TotalSalary' DESC;

                        Q 5. Get department wise maximum salary from employee table order by salary ascending
                        Ans.
                        WITH DeptSalary (DeptId, EmpSalary)
                        AS
                        (
                            SELECT DepartmentID, Salary
                            FROM OldEmployees
                        )
                        SELECT DeptId, MAX(EmpSalary) AS 'MaxSalary'
                        FROM DeptSalary
                        GROUP BY DeptId
                        ORDER BY 'MaxSalary';

                        Q 6. Get department wise minimum salary from employee table order by salary ascending
                        Ans.
                        WITH DeptSalary (DeptId, EmpSalary)
                        AS
                        (
                            SELECT DepartmentID, Salary
                            FROM OldEmployees
                        )
                        SELECT DeptId, MIN(EmpSalary) AS 'MinSalary'
                        FROM DeptSalary
                        GROUP BY DeptId
                        ORDER BY 'MinSalary';

                        Q 7. Select department, total salary with respect to a department from employee table where total salary greater than 50000 order by TotalSalary descending
                        Ans.
                        WITH DeptSalary (DeptId, EmpSalary)
                        AS
                        (
                            SELECT DepartmentID, Salary
                            FROM OldEmployees
                        )
                        SELECT DeptId, SUM(EmpSalary) AS 'TotalSalary'
                        FROM DeptSalary
                        GROUP BY DeptId
                        HAVING SUM(EmpSalary)>50000
                        ORDER BY 'TotalSalary' DESC;



                        --DAY5 TASKS

                        SELECT * FROM Employees

                        SELECT * FROM Incentives

                        Q 1. Get difference between JOINING_DATE and INCENTIVE_DATE from employee and incentives table
                        Ans.
                        WITH EmpDtDiff (EmplID, JoinDate, IncentDate)
                        AS
                        (
                            SELECT e.EmployeeID, e.JoiningDate, i.IncentiveDate 
                            FROM
                            (
                                SELECT EmployeeID, JoiningDate
                                FROM Employees
                            ) AS e
                            JOIN
                            (
                                SELECT EmpRefID, IncentiveDate
                                FROM Incentives
                            ) AS i
                            ON e.EmployeeID = i.EmpRefID
                        )
                        SELECT EmplID AS 'EmployeeID', DATEDIFF(DD, JoinDate, IncentDate) AS 'TotalDays'
                        FROM EmpDtDiff

                        Q 2. Select first_name, incentive amount from employee and incentives table for those employees who have incentives and incentive amount greater than 3000
                        Ans.
                        WITH EmpIncentAmount (EmpName, IncentAmount)
                        AS
                        (
                            SELECT e.FirstName, i.IncentiveAmount
                            FROM
                            (
                                SELECT EmployeeID, FirstName
                                FROM Employees
                            ) AS e
                            JOIN
                            (
                                SELECT EmpRefID, IncentiveAmount
                                FROM Incentives
                            ) AS i
                            ON e.EmployeeID = i.EmpRefID
                        )
                        SELECT EmpName AS 'Name', IncentAmount AS 'IncentiveAmount'
                        FROM EmpIncentAmount
                        WHERE IncentAmount>3000;

                        Q 3. Select first_name, incentive amount from employee and incentives table for all employees even if they didn�t get incentives.
                        Ans.
                        WITH EmpCTE (EmpID, Fname)
                        AS
                        (
                            SELECT EmployeeID, FirstName
                            FROM Employees
                        )
                        ,
                        IncentivesCTE (EmplRefId, IncentAmt)
                        AS
                        (
                            SELECT EmpRefID, IncentiveAmount
                            FROM Incentives
                        )
                        SELECT Fname, IncentAmt
                        FROM EmpCTE LEFT OUTER JOIN IncentivesCTE
                        ON EmpCTE.EmpID = IncentivesCTE.EmplRefId

                        /* OR, USING DERIVED TABLE

                            SELECT e.FirstName, i.IncentiveAmount
                            FROM
                            (
                                SELECT EmployeeID, FirstName
                                FROM Employees
                            ) AS e
                            LEFT OUTER JOIN
                            (
                                SELECT EmpRefID, IncentiveAmount
                                FROM Incentives
                            ) AS i
                            ON e.EmployeeID = i.EmpRefID;

                        */


                        Q 4. Select EmployeeName, ManagerName from the employee table.
                        Ans.

                            SELECT e.FirstName AS 'EmployeeName', i.FirstName AS 'ManagerName'
                            FROM
                            (
                                SELECT ManagerID, FirstName
                                FROM Employees
                            ) AS e
                            JOIN
                            (
                                SELECT EmployeeID, FirstName
                                FROM Employees
                            ) AS i
                            ON e.ManagerID = i.EmployeeID;

                        Q 5. Select first_name, incentive amount from employee and incentives table for all employees even if they didn�t get incentives and set incentive
                        amount as 0 for those employees who didn�t get incentives.
                        Ans.
                        WITH EmpCTE (EmpID, Fname)
                        AS
                        (
                            SELECT EmployeeID, FirstName
                            FROM Employees
                        )
                        ,
                        IncentivesCTE (EmplRefId, IncentAmt)
                        AS
                        (
                            SELECT EmpRefID, IncentiveAmount
                            FROM Incentives
                        )
                        SELECT Fname, ISNULL(IncentAmt, 0)
                        FROM EmpCTE LEFT OUTER JOIN IncentivesCTE
                        ON EmpCTE.EmpID = IncentivesCTE.EmplRefId

                    </pre>

                </div>
            </div>
        </div>

        <script src="../../../js/jquery.min.js"></script>
        <script src="../../../js/popper.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            function myFunc() { 
                var sidebarContent = document.getElementById("sidebar"); 
                sidebarContent.classList.toggle("active");
                return false; 
            } 
        </script>
    </body>
</html>