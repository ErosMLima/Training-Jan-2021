<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../../../css/font-awesome.min.css">
        <link rel="stylesheet" href="../../../css/bootstrap.css">
        <link rel="stylesheet" href="../../../css/style.css">
        <title>Practice</title>
    </head>

    <body>
        <!--Navbar-->
        <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top border-bottom">
            
                <a class="navbar-brand" href="../../../index.html">
                    <img src="../../../images/Radixweb.jpg" alt="" class="img-fluid" width="100px" height="100px">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link mx-3 active" href="../../../HTML/index.html">HTML</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../CSS-Practice/index.html">CSS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../BOOTSTRAP/index.html">BOOTSTRAP</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JAVASCRIPT/index.html">JAVASCRIPT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JQUERY/index.html">JQUERY</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../index.html">SQL</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../PROJECTS/index.html">PROJECTS</a>
                    </li>
                </ul>
                
                </div>
            
        </nav>
        </div>


        <div class="wrapper">
            <!-- Sidebar -->
            <nav id="sidebar">
                
                <div class="sidebar-header">
                    <h3>SQL Tasks</h3>
                </div>
                <ul class="list-unstyled components">
                    <li>
                        <a href="#day1Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day1</a>
                        <ul class="collapse list-unstyled" id="day1Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day1/Practice/Practice1.html" class="pl-5">Practice 1</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice2.html" class="pl-5">Practice 2</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice3.html" class="pl-5">Practice 3</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice4.html" class="pl-5">Practice 4</a>
                                    </li>
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day1/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                        <a href="#day2Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day2</a>
                        <ul class="collapse list-unstyled" id="day2Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day2/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day2/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day3Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day3</a>
                        <ul class="collapse list-unstyled" id="day3Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day3/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day3/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day4Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day4</a>
                        <ul class="collapse list-unstyled" id="day4Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day4/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day4/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day5Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day5</a>
                        <ul class="collapse list-unstyled" id="day5Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day5/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day5/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day6Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day6</a>
                        <ul class="collapse list-unstyled" id="day6Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day6/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day6/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day7Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day7</a>
                        <ul class="collapse list-unstyled" id="day7Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day8Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day8</a>
                        <ul class="collapse list-unstyled" id="day8Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day8/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day8/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    <li>
                                        <a href="../../Day8/Assignment/AssignmentQnA.html" class="pl-5">SQL MTA QnA</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
        
            </nav>
            <!-- Page Content -->
            <div id="content" class="w-100">
        
                <nav class="navbar navbar-expand-lg navbar-light bg-white">
                    <div class="container-fluid">
        
                        <button type="button" id="sidebarCollapse" class="btn btn-primary" onclick="return myFunc()">
                            <i class="fa fa-bars fa-align-left"></i>
                            
                        </button>
                    </div>
                </nav>

                <div class="m-3">
                    <h4>PPT & Documentation Practice</h4>
                    <pre>
                        USE Day2DB 

                        SELECT EmployeeID, FirstName, LastName, Salary INTO OldEmps
                        FROM OldEmployees
                        
                        --UNION
                        SELECT EmployeeID AS 'EmpId', FirstName AS 'Fname', LastName AS 'Lname', Salary AS 'EmpSalary'
                        FROM OldEmployees
                        WHERE EmployeeID <=120
                        UNION
                        SELECT * 
                        FROM OldEmps
                        WHERE EmployeeID>110
                        
                        SELECT EmployeeID AS 'EmpId', FirstName AS 'Fname', LastName AS 'Lname', Salary AS 'EmpSalary'
                        FROM OldEmployees
                        WHERE Salary > 7000
                        UNION
                        SELECT * 
                        FROM OldEmps
                        WHERE EmployeeID>130
                        
                        --UNION ALL
                        SELECT EmployeeID AS 'EmpId', FirstName AS 'Fname', LastName AS 'Lname', Salary AS 'EmpSalary'
                        FROM OldEmployees
                        WHERE EmployeeID <=120
                        UNION ALL
                        SELECT * 
                        FROM OldEmps
                        WHERE EmployeeID>110
                        ORDER BY EmployeeID
                        
                        USE AdventureWorks2012
                        
                        SELECT * FROM Production.ProductModel
                        
                        --USING SIMPLE UNION
                        -- Create Gloves table.  
                        SELECT ProductModelID, Name  
                        INTO Gloves  
                        FROM Production.ProductModel  
                        WHERE ProductModelID IN (3, 4);  
                        GO
                          
                        -- Here is the simple union.  
                        -- Uses AdventureWorks  
                          
                        SELECT ProductModelID, Name  
                        FROM Production.ProductModel  
                        WHERE ProductModelID NOT IN (3, 4)  
                        UNION  
                        SELECT ProductModelID, Name  
                        FROM Gloves  
                        ORDER BY Name;  
                        GO
                        
                        --USING SELECT INTO WITH UNION
                        -- Uses AdventureWorks  
                          
                        SELECT ProductModelID, Name  
                        INTO dbo.ProductResults  
                        FROM Production.ProductModel  
                        WHERE ProductModelID NOT IN (3, 4)  
                        UNION  
                        SELECT ProductModelID, Name  
                        FROM Gloves;  
                        GO  
                          
                        SELECT ProductModelID, Name   
                        FROM dbo.ProductResults;  
                        
                        
                        --UNION OF 3 SELECT STATEMENTS
                        -- Uses AdventureWorks   
                          
                        SELECT pp.LastName, pp.FirstName, e.JobTitle   
                        INTO dbo.EmployeeOne  
                        FROM Person.Person AS pp JOIN HumanResources.Employee AS e  
                        ON e.BusinessEntityID = pp.BusinessEntityID  
                        WHERE LastName = 'Johnson';  
                        GO  
                        
                        SELECT pp.LastName, pp.FirstName, e.JobTitle   
                        INTO dbo.EmployeeTwo  
                        FROM Person.Person AS pp JOIN HumanResources.Employee AS e  
                        ON e.BusinessEntityID = pp.BusinessEntityID  
                        WHERE LastName = 'Johnson';  
                        GO  
                        
                        SELECT pp.LastName, pp.FirstName, e.JobTitle   
                        INTO dbo.EmployeeThree  
                        FROM Person.Person AS pp JOIN HumanResources.Employee AS e  
                        ON e.BusinessEntityID = pp.BusinessEntityID  
                        WHERE LastName = 'Johnson';  
                        GO  
                        
                        -- Union ALL  
                        SELECT LastName, FirstName, JobTitle  
                        FROM dbo.EmployeeOne  
                        UNION ALL  
                        SELECT LastName, FirstName ,JobTitle  
                        FROM dbo.EmployeeTwo  
                        UNION ALL  
                        SELECT LastName, FirstName,JobTitle   
                        FROM dbo.EmployeeThree;  
                        GO  
                          
                        SELECT LastName, FirstName,JobTitle  
                        FROM dbo.EmployeeOne  
                        UNION   
                        SELECT LastName, FirstName, JobTitle   
                        FROM dbo.EmployeeTwo  
                        UNION   
                        SELECT LastName, FirstName, JobTitle   
                        FROM dbo.EmployeeThree;  
                        GO  
                          
                        SELECT LastName, FirstName,JobTitle   
                        FROM dbo.EmployeeOne  
                        UNION ALL  
                        (  
                        SELECT LastName, FirstName, JobTitle   
                        FROM dbo.EmployeeTwo  
                        UNION  
                        SELECT LastName, FirstName, JobTitle   
                        FROM dbo.EmployeeThree  
                        );  
                        GO
                        
                        --INTERSECT
                        SELECT EmployeeID AS 'EmpId', FirstName AS 'Fname', LastName AS 'Lname', Salary AS 'EmpSalary'
                        FROM OldEmployees
                        WHERE EmployeeID <=120
                        INTERSECT
                        SELECT * 
                        FROM OldEmps
                        WHERE EmployeeID>110
                        
                        --uses AdventureWorks
                        
                        SELECT ProductID   
                        FROM Production.Product  
                        INTERSECT  
                        SELECT ProductID   
                        FROM Production.WorkOrder ;  
                        
                        --EXCEPT
                        SELECT EmployeeID AS 'EmpId', FirstName AS 'Fname', LastName AS 'Lname', Salary AS 'EmpSalary'
                        FROM OldEmployees
                        WHERE EmployeeID <=120
                        EXCEPT
                        SELECT * 
                        FROM OldEmps
                        WHERE EmployeeID>110
                        
                        -- Uses AdventureWorks  
                          
                        SELECT ProductID   
                        FROM Production.Product  
                        EXCEPT  
                        SELECT ProductID   
                        FROM Production.WorkOrder ; 
                        
                        --DERIVED TABLES
                        SELECT DISTINCT Salary
                        FROM (
                            SELECT DENSE_RANK() OVER (ORDER BY Salary DESC) 'dRank', *
                            FROM OldEmployees
                        ) tblTemp
                        WHERE dRank = 2
                        
                        USE Day6DB
                        
                        SELECT * FROM Employees
                        
                        SELECT * FROM Departments
                        
                        SELECT FirstName, dept.DepartmentName
                        FROM Employees
                        JOIN (
                            SELECT DepartmentID, DepartmentName
                            FROM Departments
                            ) dept
                        ON dept.DepartmentID = Employees.DepartmentID
                        
                        
                        --CTE
                        
                        SELECT * FROM Sales.SalesOrderHeader
                        
                        WITH SalesCTE (SalesPersonId, NumberOfOrders)
                        AS
                        (
                            SELECT SalesPersonID, COUNT(*)
                            FROM Sales.SalesOrderHeader
                            WHERE SalesPersonID IS NOT NULL
                            GROUP BY SalesPersonID
                        )
                        SELECT AVG(NumberOfOrders) AS 'Average Sales Per Person'
                        FROM SalesCTE
                        
                        --SIMPLE CTE  
                        WITH Sales_CTE (SalesPersonID, SalesOrderID, SalesYear)  
                        AS  
                        -- Define the CTE query.  
                        (  
                            SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
                            FROM Sales.SalesOrderHeader  
                            WHERE SalesPersonID IS NOT NULL  
                        )  
                        -- Define the outer query referencing the CTE name.  
                        SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
                        FROM Sales_CTE  
                        GROUP BY SalesYear, SalesPersonID  
                        ORDER BY SalesPersonID, SalesYear;
                        
                        --MULTIPLE CTE IN SINGLE QUERY
                        WITH Sales_CTE (SalesPersonID, TotalSales, SalesYear)  
                        AS  
                        -- Define the first CTE query.  
                        (  
                            SELECT SalesPersonID, SUM(TotalDue) AS TotalSales, YEAR(OrderDate) AS SalesYear  
                            FROM Sales.SalesOrderHeader  
                            WHERE SalesPersonID IS NOT NULL  
                               GROUP BY SalesPersonID, YEAR(OrderDate)  
                          
                        )  
                        ,   -- Use a comma to separate multiple CTE definitions.  
                          
                        -- Define the second CTE query, which returns sales quota data by year for each sales person.  
                        Sales_Quota_CTE (BusinessEntityID, SalesQuota, SalesQuotaYear)  
                        AS  
                        (  
                               SELECT BusinessEntityID, SUM(SalesQuota)AS SalesQuota, YEAR(QuotaDate) AS SalesQuotaYear  
                               FROM Sales.SalesPersonQuotaHistory  
                               GROUP BY BusinessEntityID, YEAR(QuotaDate)  
                        )  
                          
                        -- Define the outer query by referencing columns from both CTEs.  
                        SELECT SalesPersonID  
                          , SalesYear  
                          , FORMAT(TotalSales,'C','en-us') AS TotalSales  
                          , SalesQuotaYear  
                          , FORMAT (SalesQuota,'C','en-us') AS SalesQuota  
                          , FORMAT (TotalSales -SalesQuota, 'C','en-us') AS Amt_Above_or_Below_Quota  
                        FROM Sales_CTE  
                        JOIN Sales_Quota_CTE ON Sales_Quota_CTE.BusinessEntityID = Sales_CTE.SalesPersonID  
                                            AND Sales_CTE.SalesYear = Sales_Quota_CTE.SalesQuotaYear  
                        ORDER BY SalesPersonID, SalesYear;
                        
                        --RECURSIVE CTE
                        -- Create an Employee table.  
                        CREATE TABLE MyEmployees  
                        (  
                        EmployeeID SMALLINT NOT NULL,  
                        FirstName NVARCHAR(30)  NOT NULL,  
                        LastName  NVARCHAR(40) NOT NULL,  
                        Title NVARCHAR(50) NOT NULL,  
                        DeptID SMALLINT NOT NULL,  
                        ManagerID INT NULL,  
                         CONSTRAINT PK_EmployeeID PRIMARY KEY CLUSTERED (EmployeeID ASC)   
                        );  
                        -- Populate the table with values.  
                        INSERT INTO MyEmployees VALUES   
                         (1, N'Ken', N'S�nchez', N'Chief Executive Officer',16,NULL)  
                        ,(273, N'Brian', N'Welcker', N'Vice President of Sales',3,1)  
                        ,(274, N'Stephen', N'Jiang', N'North American Sales Manager',3,273)  
                        ,(275, N'Michael', N'Blythe', N'Sales Representative',3,274)  
                        ,(276, N'Linda', N'Mitchell', N'Sales Representative',3,274)  
                        ,(285, N'Syed', N'Abbas', N'Pacific Sales Manager',3,273)  
                        ,(286, N'Lynn', N'Tsoflias', N'Sales Representative',3,285)  
                        ,(16,  N'David',N'Bradley', N'Marketing Manager', 4, 273)  
                        ,(23,  N'Mary', N'Gibson', N'Marketing Specialist', 4, 16);
                        
                        WITH DirectReports(ManagerID, EmployeeID, Title, EmployeeLevel) AS   
                        (  
                            SELECT ManagerID, EmployeeID, Title, 0 AS EmployeeLevel  
                            FROM MyEmployees   
                            WHERE ManagerID IS NULL  
                            UNION ALL  
                            SELECT e.ManagerID, e.EmployeeID, e.Title, EmployeeLevel + 1  
                            FROM MyEmployees AS e  
                                INNER JOIN DirectReports AS d  
                                ON e.ManagerID = d.EmployeeID   
                        )  
                        SELECT ManagerID, EmployeeID, Title, EmployeeLevel   
                        FROM DirectReports  
                        ORDER BY ManagerID;
                        
                        
                    </pre>

                </div>
            </div>
        </div>

        <script src="../../../js/jquery.min.js"></script>
        <script src="../../../js/popper.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            function myFunc() { 
                var sidebarContent = document.getElementById("sidebar"); 
                sidebarContent.classList.toggle("active");
                return false; 
            } 
        </script>
    </body>
</html>