<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../../../css/font-awesome.min.css">
        <link rel="stylesheet" href="../../../css/bootstrap.css">
        <link rel="stylesheet" href="../../../css/style.css">
        <title>Practice</title>
    </head>

    <body>
        <!--Navbar-->
        <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top border-bottom">
            
                <a class="navbar-brand" href="../../../index.html">
                    <img src="../../../images/Radixweb.jpg" alt="" class="img-fluid" width="100px" height="100px">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link mx-3 active" href="../../../HTML/index.html">HTML</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../CSS-Practice/index.html">CSS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../BOOTSTRAP/index.html">BOOTSTRAP</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JAVASCRIPT/index.html">JAVASCRIPT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JQUERY/index.html">JQUERY</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../index.html">SQL</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../PROJECTS/index.html">PROJECTS</a>
                    </li>
                </ul>
                
                </div>
            
        </nav>
        </div>


        <div class="wrapper">
            <!-- Sidebar -->
            <nav id="sidebar">
                
                <div class="sidebar-header">
                    <h3>SQL Tasks</h3>
                </div>
                <ul class="list-unstyled components">
                    <li>
                        <a href="#day1Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day1</a>
                        <ul class="collapse list-unstyled" id="day1Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day1/Practice/Practice1.html" class="pl-5">Practice 1</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day1/Practice/Practice2.html" class="pl-5">Practice 2</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day1/Practice/Practice3.html" class="pl-5">Practice 3</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day1/Practice/Practice4.html" class="pl-5">Practice 4</a>
                                    </li>
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day1/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                        <a href="#day2Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day2</a>
                        <ul class="collapse list-unstyled" id="day2Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day2/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day2/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day3Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day3</a>
                        <ul class="collapse list-unstyled" id="day3Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day3/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day3/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day4Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day4</a>
                        <ul class="collapse list-unstyled" id="day4Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day4/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day4/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day5Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day5</a>
                        <ul class="collapse list-unstyled" id="day5Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day5/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day5/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day6Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day6</a>
                        <ul class="collapse list-unstyled" id="day6Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day6/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day6/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day7Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day7</a>
                        <ul class="collapse list-unstyled" id="day7Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day7/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day7/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day8Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day8</a>
                        <ul class="collapse list-unstyled" id="day8Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day8/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day8/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day8/Assignment/AssignmentQnA.html" class="pl-5">SQL MTA QnA</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day9Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day9</a>
                        <ul class="collapse list-unstyled" id="day9Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day9/Disha-Shah/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day9/Disha-Shah/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day10Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day10</a>
                        <ul class="collapse list-unstyled" id="day10Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day10/Disha-Shah/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day10/Disha-Shah/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day11Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day11</a>
                        <ul class="collapse list-unstyled" id="day11Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day12Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day12</a>
                        <ul class="collapse list-unstyled" id="day12Submenu">
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day12/Disha-Shah/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day13Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day13</a>
                        <ul class="collapse list-unstyled" id="day13Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day13/Disha-Shah/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day13/Disha-Shah/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day14Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day14</a>
                        <ul class="collapse list-unstyled" id="day14Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day14/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day14/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day15Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day15</a>
                        <ul class="collapse list-unstyled" id="day15Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day15/Practice/PPT&MsdnPractice.html" class="pl-5">PPT & MSDN practice</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day15/Practice/ProcedurePractice.html" class="pl-5">Procedure Practice Tasks</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day15/Practice/IsolationLevels1.html" class="pl-5">Isolation Levels-1</a>
                                    </li>
                                    <li>
                                        <a href="../../../Day15/Practice/IsolationLevels2.html" class="pl-5">Isolation Levels-2</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../../Day15/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day18Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day18</a>
                        <ul class="collapse list-unstyled" id="day18Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../../Day18/Disha-Shah/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                        </ul>
                    </li>

                    
                </ul>
        
            </nav>
            <!-- Page Content -->
            <div id="content" class="w-100">
        
                <nav class="navbar navbar-expand-lg navbar-light bg-white">
                    <div class="container-fluid">
        
                        <button type="button" id="sidebarCollapse" class="btn btn-primary" onclick="return myFunc()">
                            <i class="fa fa-bars fa-align-left"></i>
                            
                        </button>
                    </div>
                </nav>

                <div class="m-3">
                    <h4>MSDN Practice</h4>
                    <pre>USE AdventureWorks2012

                        --STORED PROCEDURES
                        
                        --CREATING STORED PROCEDURE USIN TRANSACT SQL
                        CREATE PROCEDURE HumanResources.uspGetEmployeesTest2
                            @Lastname NVARCHAR(50),
                            @Firstname NVARCHAR(50)
                        AS
                            SET NOCOUNT ON;
                            SELECT FirstName, LastName, Department 
                            FROM HumanResources.vEmployeeDepartmentHistory
                            WHERE FirstName = @Firstname AND LastName = @Lastname AND EndDate IS NULL;
                        GO
                        
                        --EXECUTING STORED PROCEDURE
                        EXECUTE HumanResources.uspGetEmployeesTest2 N'Ackerman', N'Pilar';
                        GO
                        
                        --OR,
                        EXEC HumanResources.uspGetEmployeesTest2 @Lastname = N'Ackerman', @Firstname = N'Pilar';
                        GO
                        
                        --OR,
                        EXECUTE HumanResources.uspGetEmployeesTest2 @Firstname = N'Pilar', @Lastname = N'Ackerman';
                        GO
                        
                        --RETURN VALUES FROM STORED PROCEDURES
                        ALTER PROCEDURE prcGetEmployeeDetail @EmpId INT, @DepName CHAR(50) OUTPUT, @ShiftId INT OUTPUT
                        AS
                        BEGIN
                        IF EXISTS(SELECT * FROM HumanResources.Employee WHERE BusinessEntityID = @EmpId)
                        BEGIN
                        SELECT @DepName = d.Name, @ShiftId = h.ShiftID
                        FROM HumanResources.Department AS d JOIN HumanResources.EmployeeDepartmentHistory AS h
                        ON d.DepartmentID = h.DepartmentID
                        WHERE h.BusinessEntityID = @EmpId AND h.EndDate IS NULL
                        RETURN 0
                        END
                        END
                        
                        DECLARE @DepName CHAR(50), @ShiftId INT
                        EXECUTE prcGetEmployeeDetail 4, @DepName OUTPUT, @ShiftId OUTPUT;
                        PRINT @DepName;
                        PRINT @ShiftId;
                        GO
                        
                        SELECT * FROM HumanResources.Department
                        SELECT * FROM HumanResources.EmployeeDepartmentHistory
                        
                        
                        --CALL A PROCEDURE FROM ANOTHER PROCEDURE
                        CREATE PROCEDURE prcDisplayEmployeeStatus @EmpId INT
                        WITH ENCRYPTION
                        AS
                        BEGIN
                        DECLARE @Depname CHAR(50), @ShiftId INT, @ReturnValue INT
                        EXEC @ReturnValue = prcGetEmployeeDetail @EmpId, @Depname OUTPUT, @ShiftId OUTPUT
                        IF (@ReturnValue = 0)
                        BEGIN
                        PRINT 'The details of an employee with ID: ' + CONVERT(CHAR(10), @EmpId)
                        PRINT 'Department name: ' + @Depname
                        PRINT 'ShiftId: ' + CONVERT(CHAR(1), @ShiftId)
                        SELECT BusinessEntityID, JobTitle FROM HumanResources.Employee
                        WHERE BusinessEntityID = @EmpId
                        END
                        ELSE
                        PRINT 'No records found for the given employee'
                        END
                        
                        EXECUTE prcDisplayEmployeeStatus 14;
                        GO
                        
                        --WITH ENCRYPTION OUTPUT
                        EXEC sys.sp_helptext prcDisplayEmployeeStatus
                        
                        
                        --MODIFY PROCEDURE USING TRANSACT SQL
                        IF OBJECT_ID ( 'Purchasing.uspVendorAllInfo', 'P' ) IS NOT NULL   
                            DROP PROCEDURE Purchasing.uspVendorAllInfo;  
                        GO  
                        CREATE PROCEDURE Purchasing.uspVendorAllInfo  
                        WITH EXECUTE AS CALLER  
                        AS  
                            SET NOCOUNT ON;  
                            SELECT v.Name AS Vendor, p.Name AS 'Product name',   
                              v.CreditRating AS 'Rating',   
                              v.ActiveFlag AS Availability  
                            FROM Purchasing.Vendor v   
                            INNER JOIN Purchasing.ProductVendor pv  
                              ON v.BusinessEntityID = pv.BusinessEntityID   
                            INNER JOIN Production.Product p  
                              ON pv.ProductID = p.ProductID   
                            ORDER BY v.Name ASC;  
                        GO
                        
                        ALTER PROCEDURE Purchasing.uspVendorAllInfo  
                            @Product varchar(25)   
                        AS  
                            SET NOCOUNT ON;  
                            SELECT LEFT(v.Name, 25) AS Vendor, LEFT(p.Name, 25) AS 'Product name',   
                            'Rating' = CASE v.CreditRating   
                                WHEN 1 THEN 'Superior'  
                                WHEN 2 THEN 'Excellent'  
                                WHEN 3 THEN 'Above average'  
                                WHEN 4 THEN 'Average'  
                                WHEN 5 THEN 'Below average'  
                                ELSE 'No rating'  
                                END  
                            , Availability = CASE v.ActiveFlag  
                                WHEN 1 THEN 'Yes'  
                                ELSE 'No'  
                                END  
                            FROM Purchasing.Vendor AS v   
                            INNER JOIN Purchasing.ProductVendor AS pv  
                              ON v.BusinessEntityID = pv.BusinessEntityID   
                            INNER JOIN Production.Product AS p   
                              ON pv.ProductID = p.ProductID   
                            WHERE p.Name LIKE @Product  
                            ORDER BY v.Name ASC;  
                        GO
                        
                        EXEC Purchasing.uspVendorAllInfo N'LL Crankarm';  
                        GO
                        
                        
                        --VIEW ALL THE STORED PROCEDURES IN THE DATABASE
                        SELECT name AS procedure_name   
                            ,SCHEMA_NAME(schema_id) AS schema_name  
                            ,type_desc  
                            ,create_date  
                            ,modify_date  
                        FROM sys.procedures;
                        
                        --DELETE PROCEDURE
                        DROP PROCEDURE HumanResources.uspGetEmployeesTest2;  
                        GO
                        
                        --SYSTEM STORED PROCEDURES
                        EXEC sys.sp_who;
                        GO
                        
                        
                        --SPECIFY PARAMETERS
                        -- Passing values as constants.  
                        EXEC dbo.uspGetWhereUsedProductID 819, '20050225';  
                        GO  
                        -- Passing values as variables.  
                        DECLARE @ProductID int, @CheckDate datetime;  
                        SET @ProductID = 819;  
                        SET @CheckDate = '20050225';  
                        EXEC dbo.uspGetWhereUsedProductID @ProductID, @CheckDate;  
                        GO  
                        -- Try to use a function as a parameter value.  
                        -- This produces an error message.  
                        EXEC dbo.uspGetWhereUsedProductID 819, GETDATE();  
                        GO  
                        -- Passing the function value as a variable.  
                        DECLARE @CheckDate datetime;  
                        SET @CheckDate = GETDATE();  
                        EXEC dbo.uspGetWhereUsedProductID 819, @CheckDate;  
                        GO  
                        
                        
                        
                        --SPECIFYING DEFAULT VALUES TO PARAMETER
                        IF OBJECT_ID('Sales.uspGetSalesYTD', 'P') IS NOT NULL  
                            DROP PROCEDURE Sales.uspGetSalesYTD;  
                        GO  
                        CREATE PROCEDURE Sales.uspGetSalesYTD  
                        @SalesPerson nvarchar(50) = NULL  -- NULL default value  
                        AS   
                            SET NOCOUNT ON;   
                          
                        -- Validate the @SalesPerson parameter.  
                        IF @SalesPerson IS NULL  
                        BEGIN  
                           PRINT 'ERROR: You must specify the last name of the sales person.'  
                           RETURN  
                        END  
                        -- Get the sales for the specified sales person and   
                        -- assign it to the output parameter.  
                        SELECT SalesYTD  
                        FROM Sales.SalesPerson AS sp  
                        JOIN HumanResources.vEmployee AS e ON e.BusinessEntityID = sp.BusinessEntityID  
                        WHERE LastName = @SalesPerson;  
                        RETURN  
                        GO  
                        
                        -- Run the procedure without specifying an input value.  
                        EXEC Sales.uspGetSalesYTD;  
                        GO  
                        -- Run the procedure with an input value.  
                        EXEC Sales.uspGetSalesYTD N'Blythe';  
                        GO 
                        
                        
                        
                        --PARAMETERS
                        -- Create a procedure that takes one input parameter and returns one output parameter and a return code.
                        CREATE PROCEDURE SampleProcedure @EmployeeIDParm INT,
                                 @MaxTotal INT OUTPUT
                        AS
                        -- Declare and initialize a variable to hold @@ERROR.
                        DECLARE @ErrorSave INT
                        SET @ErrorSave = 0
                        
                        -- Do a SELECT using the input parameter.
                        SELECT FirstName, LastName, JobTitle
                        FROM HumanResources.vEmployee
                        WHERE BusinessEntityID = @EmployeeIDParm
                        
                        -- Save any nonzero @@ERROR value.
                        IF (@@ERROR <> 0)
                           SET @ErrorSave = @@ERROR
                        
                        -- Set a value in the output parameter.
                        SELECT @MaxTotal = MAX(TotalDue)
                        FROM Sales.SalesOrderHeader;
                        
                        IF (@@ERROR <> 0)
                           SET @ErrorSave = @@ERROR
                        
                        -- Returns 0 if neither SELECT statement had an error; otherwise, returns the last error.
                        RETURN @ErrorSave
                        GO
                        
                        -- Declare the variables for the return code and output parameter.
                        DECLARE @ReturnCode INT
                        DECLARE @MaxTotalVariable INT
                        
                        -- Execute the stored procedure and specify which variables
                        -- are to receive the output parameter and return code values.
                        EXEC @ReturnCode = SampleProcedure @EmployeeIDParm = 19,
                           @MaxTotal = @MaxTotalVariable OUTPUT
                        
                        -- Show the values returned.
                        PRINT ' '
                        PRINT 'Return code = ' + CAST(@ReturnCode AS CHAR(10))
                        PRINT 'Maximum Quantity = ' + CAST(@MaxTotalVariable AS CHAR(10))
                        GO
                        
                        
                        --RETURNING DATA USING A RESULT SET
                        IF OBJECT_ID('Sales.uspGetEmployeeSalesYTD', 'P') IS NOT NULL  
                           DROP PROCEDURE Sales.uspGetEmployeeSalesYTD;  
                        GO  
                        CREATE PROCEDURE Sales.uspGetEmployeeSalesYTD 
                        
                        AS    
                           
                           SET NOCOUNT ON;  
                           SELECT LastName, SalesYTD  
                           FROM Sales.SalesPerson AS sp  
                           JOIN HumanResources.vEmployee AS e ON e.BusinessEntityID = sp.BusinessEntityID  
                           
                        RETURN  
                        GO  
                        
                        EXEC Sales.uspGetEmployeeSalesYTD
                        
                        
                        
                        --
                        IF OBJECT_ID('Sales.uspGetEmployeeSalesYTD', 'P') IS NOT NULL  
                            DROP PROCEDURE Sales.uspGetEmployeeSalesYTD;  
                        GO  
                        CREATE PROCEDURE Sales.uspGetEmployeeSalesYTD  
                        @SalesPerson nvarchar(50),  
                        @SalesYTD money OUTPUT  
                        AS    
                          
                            SET NOCOUNT ON;  
                            SELECT @SalesYTD = SalesYTD  
                            FROM Sales.SalesPerson AS sp  
                            JOIN HumanResources.vEmployee AS e ON e.BusinessEntityID = sp.BusinessEntityID  
                            WHERE LastName = @SalesPerson;  
                        RETURN  
                        GO  
                        
                        -- Declare the variable to receive the output value of the procedure.  
                        DECLARE @SalesYTDBySalesPerson money;  
                        -- Execute the procedure specifying a last name for the input parameter  
                        -- and saving the output value in the variable @SalesYTDBySalesPerson  
                        EXECUTE Sales.uspGetEmployeeSalesYTD  
                            N'Blythe', @SalesYTD = @SalesYTDBySalesPerson OUTPUT;  
                        -- Display the value returned by the procedure.  
                        PRINT 'Year-to-date sales for this employee is ' +   
                            convert(varchar(10),@SalesYTDBySalesPerson);  
                        GO  
                        
                        
                        
                        --RECOMPILE
                        IF OBJECT_ID ( 'dbo.uspProductByVendor', 'P' ) IS NOT NULL   
                            DROP PROCEDURE dbo.uspProductByVendor;  
                        GO  
                        CREATE PROCEDURE dbo.uspProductByVendor @Name varchar(30) = '%'  
                        WITH RECOMPILE  
                        AS  
                            SET NOCOUNT ON;  
                            SELECT v.Name AS 'Vendor name', p.Name AS 'Product name'  
                            FROM Purchasing.Vendor AS v   
                            JOIN Purchasing.ProductVendor AS pv   
                              ON v.BusinessEntityID = pv.BusinessEntityID   
                            JOIN Production.Product AS p   
                              ON pv.ProductID = p.ProductID  
                            WHERE v.Name LIKE @Name; 
                        
                        EXECUTE dbo.uspProductByVendor WITH RECOMPILE;  
                        GO
                        
                        EXEC sp_recompile N'dbo.uspProductByVendor';   
                        GO
                        
                        
                        --RENAMING
                        CREATE PROCEDURE HumanResources.uspGetAllEmployeesTest  
                        AS  
                            SET NOCOUNT ON;  
                            SELECT LastName, FirstName, Department  
                            FROM HumanResources.vEmployeeDepartmentHistory;  
                        GO  
                          
                        --Rename the stored procedure.  
                        EXEC sp_rename 'HumanResources.uspGetAllEmployeesTest', 'uspEveryEmployeeTest'; 
                        
                        
                        
                        --EXCEPTION HANDLING
                        
                        --TRY-CATCH
                        -- Verify that the stored procedure does not already exist.  
                        IF OBJECT_ID ( 'usp_GetErrorInfo', 'P' ) IS NOT NULL   
                            DROP PROCEDURE usp_GetErrorInfo;  
                        GO  
                          
                        -- Create procedure to retrieve error information.  
                        CREATE PROCEDURE usp_GetErrorInfo  
                        AS  
                        SELECT  
                            ERROR_NUMBER() AS ErrorNumber  
                            ,ERROR_SEVERITY() AS ErrorSeverity  
                            ,ERROR_STATE() AS ErrorState  
                            ,ERROR_PROCEDURE() AS ErrorProcedure  
                            ,ERROR_LINE() AS ErrorLine  
                            ,ERROR_MESSAGE() AS ErrorMessage;  
                        GO  
                          
                        BEGIN TRY  
                            -- Generate divide-by-zero error.  
                            SELECT 1/0;  
                        END TRY  
                        BEGIN CATCH  
                            -- Execute error retrieval routine.  
                            EXECUTE usp_GetErrorInfo;  
                        END CATCH;
                        
                        
                        --ERROR NOT CAUGHT BY TRY_CATCH BLOCK
                        BEGIN TRY  
                            -- Table does not exist; object name resolution  
                            -- error not caught.  
                            SELECT * FROM NonexistentTable;  
                        END TRY  
                        BEGIN CATCH  
                            SELECT   
                                ERROR_NUMBER() AS ErrorNumber  
                               ,ERROR_MESSAGE() AS ErrorMessage;  
                        END CATCH
                        
                        
                        --SAME ERROR IS CAUGHT BY TRY_CATCH BLOCK, USING PROCEDURES
                        -- Verify that the stored procedure does not exist.  
                        IF OBJECT_ID ( N'usp_ExampleProc', N'P' ) IS NOT NULL   
                            DROP PROCEDURE usp_ExampleProc;  
                        GO  
                          
                        -- Create a stored procedure that will cause an   
                        -- object resolution error.  
                        CREATE PROCEDURE usp_ExampleProc  
                        AS  
                            SELECT * FROM NonexistentTable;  
                        GO  
                          
                        BEGIN TRY  
                            EXECUTE usp_ExampleProc;  
                        END TRY  
                        BEGIN CATCH  
                            SELECT   
                                ERROR_NUMBER() AS ErrorNumber  
                                ,ERROR_MESSAGE() AS ErrorMessage;  
                        END CATCH;
                        
                        
                        
                        
                        --RAISERROR
                        
                        --RETURNING ERROR INFORMATION FROM CATCH BLOCK
                        BEGIN TRY  
                            -- RAISERROR with severity 11-19 will cause execution to   
                            -- jump to the CATCH block.  
                            RAISERROR ('Error raised in TRY block.', -- Message text.  
                                       16, -- Severity.  
                                       1 -- State.  
                                       );  
                        END TRY  
                        BEGIN CATCH  
                            DECLARE @ErrorMessage NVARCHAR(4000);  
                            DECLARE @ErrorSeverity INT;  
                            DECLARE @ErrorState INT;  
                          
                            SELECT   
                                @ErrorMessage = ERROR_MESSAGE(),  
                                @ErrorSeverity = ERROR_SEVERITY(),  
                                @ErrorState = ERROR_STATE();  
                          
                            -- Use RAISERROR inside the CATCH block to return error  
                            -- information about the original error that caused  
                            -- execution to jump to the CATCH block.  
                            RAISERROR (@ErrorMessage, -- Message text.  
                                       @ErrorSeverity, -- Severity.  
                                       @ErrorState -- State.  
                                       );  
                        END CATCH;
                        
                        
                        --USE LOCAL VARIABLE TO SUPPLY MESSAGE
                        DECLARE @StringVariable NVARCHAR(50);  
                        SET @StringVariable = N'<\<%7.3s>>';  
                          
                        RAISERROR (@StringVariable, -- Message text.  
                                   10, -- Severity,  
                                   1, -- State,  
                                   N'abcde'); -- First argument supplies the string.  
                        -- The message text returned is: <<    abc>>.  
                        GO
                        
                        
                        --
                        BEGIN TRY
                        DECLARE @num1 INT, @num2 INT, @num3 INT
                        SET @num1=10
                        SET @num2=0
                        IF @num2=0
                            RAISERROR('Denominator can not be zero', 10, 1)
                        ELSE
                            SET @num3=@num1/@num2
                            PRINT @num3
                        END TRY
                        BEGIN CATCH
                        PRINT ERROR_MESSAGE()
                        END CATCH
                        
                        
                        
                        --@@IDENTITY
                        --Display the value of LocationID in the last row in the table.  
                        SELECT MAX(LocationID) FROM Production.Location;  
                        GO  
                        INSERT INTO Production.Location (Name, CostRate, Availability, ModifiedDate)  
                        VALUES ('Damaged Goods', 5, 2.5, GETDATE());  
                        GO  
                        SELECT @@IDENTITY AS 'Identity';  
                        GO  
                        --Display the value of LocationID of the newly inserted row.  
                        SELECT MAX(LocationID) FROM Production.Location;  
                        GO  
                        
                        USE SampleDB
                        
                        INSERT INTO Tests VALUES('Rita')
                        PRINT @@IDENTITY
                        
                        ALTER PROCEDURE prcTests @json NVARCHAR(MAX)
                        AS
                        BEGIN
                        DECLARE @name VARCHAR(50)
                        SELECT @name=Name 
                        FROM OPENJSON(@json)
                        WITH (
                            Name VARCHAR(50) '$.Name'
                        )
                        INSERT INTO Tests VALUES(@name)
                        RETURN @@IDENTITY
                        END
                        
                        DECLARE @json NVARCHAR(MAX), @Id INT
                        SET @json='[{"Name": "Rima"}]'
                        EXECUTE @Id = prcTests @json
                        PRINT @Id</pre>

                </div>
            </div>
        </div>

        <script src="../../../js/jquery.min.js"></script>
        <script src="../../../js/popper.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            function myFunc() { 
                var sidebarContent = document.getElementById("sidebar"); 
                sidebarContent.classList.toggle("active");
                return false; 
            } 
        </script>
    </body>
</html>