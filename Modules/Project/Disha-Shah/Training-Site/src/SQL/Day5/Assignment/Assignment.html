<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../../../css/font-awesome.min.css">
        <link rel="stylesheet" href="../../../css/bootstrap.css">
        <link rel="stylesheet" href="../../../css/style.css">
        <title>Assignment</title>
    </head>

    <body>
        <!--Navbar-->
        <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top border-bottom">
            
                <a class="navbar-brand" href="../../../index.html">
                    <img src="../../../images/Radixweb.jpg" alt="" class="img-fluid" width="100px" height="100px">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link mx-3 active" href="../../../HTML/index.html">HTML</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../CSS-Practice/index.html">CSS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../BOOTSTRAP/index.html">BOOTSTRAP</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JAVASCRIPT/index.html">JAVASCRIPT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../JQUERY/index.html">JQUERY</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../index.html">SQL</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mx-3" href="../../../PROJECTS/index.html">PROJECTS</a>
                    </li>
                </ul>
                
                </div>
            
        </nav>
        </div>


        <div class="wrapper">
            <!-- Sidebar -->
            <nav id="sidebar">
                
                <div class="sidebar-header">
                    <h3>SQL Tasks</h3>
                </div>
                <ul class="list-unstyled components">
                    <li>
                        <a href="#day1Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day1</a>
                        <ul class="collapse list-unstyled" id="day1Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day1/Practice/Practice1.html" class="pl-5">Practice 1</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice2.html" class="pl-5">Practice 2</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice3.html" class="pl-5">Practice 3</a>
                                    </li>
                                    <li>
                                        <a href="../../Day1/Practice/Practice4.html" class="pl-5">Practice 4</a>
                                    </li>
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day1/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                        <a href="#day2Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day2</a>
                        <ul class="collapse list-unstyled" id="day2Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day2/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day2/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day3Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day3</a>
                        <ul class="collapse list-unstyled" id="day3Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day3/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day3/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day4Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day4</a>
                        <ul class="collapse list-unstyled" id="day4Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day4/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day4/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day5Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day5</a>
                        <ul class="collapse list-unstyled" id="day5Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                        <a href="#day6Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day6</a>
                        <ul class="collapse list-unstyled" id="day6Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day6/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day6/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#day7Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Day7</a>
                        <ul class="collapse list-unstyled" id="day7Submenu">
                            
                            <li>
                                <a href="#practiceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Practice</a>
                                <ul class="collapse list-unstyled" id="practiceSubmenu">
                                    <li>
                                        <a href="../../Day7/Practice/Practice.html" class="pl-5">Practice Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                            
                            <li>
                                <a href="#assignmentSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Assignment</a>
                                <ul class="collapse list-unstyled" id="assignmentSubmenu">
                                    <li>
                                        <a href="../../Day7/Assignment/Assignment.html" class="pl-5">Assignment Tasks</a>
                                    </li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
        
            </nav>
            <!-- Page Content -->
            <div id="content" class="w-100">
        
                <nav class="navbar navbar-expand-lg navbar-light bg-white">
                    <div class="container-fluid">
        
                        <button type="button" id="sidebarCollapse" class="btn btn-primary" onclick="return myFunc()">
                            <i class="fa fa-bars fa-align-left"></i>
                            
                        </button>
                    </div>
                </nav>

                <div class="m-3">
                    <h4>Training Site Assignment Tasks</h4>
                    <pre>
                        USE Day2DB

                        CREATE TABLE Employees(
                            EmployeeID INT CONSTRAINT pkEmpID PRIMARY KEY,
                            FirstName VARCHAR(25) NOT NULL,
                            LastName VARCHAR(25) NOT NULL,
                            Salary INT,
                            JoiningDate DATETIME NOT NULL,
                            Department VARCHAR(50) NOT NULL,
                            ManagerID INT
                        )

                        CREATE TABLE Incentives(
                            EmpRefID INT CONSTRAINT fkEmpRefID FOREIGN KEY REFERENCES Employees(EmployeeID),
                            IncentiveDate DATE NOT NULL,
                            IncentiveAmount INT NOT NULL
                        )

                        SELECT * FROM Employees

                        SELECT * FROM Incentives

                        Q 1. Get difference between JOINING_DATE and INCENTIVE_DATE from employee and incentives table
                        Ans.
                        SELECT e.EmployeeID, DATEDIFF(DD, e.JoiningDate, i.IncentiveDate) AS 'TotalDays'
                        FROM Employees AS e INNER JOIN Incentives AS i
                        ON e.EmployeeID = i.EmpRefID

                        Q 2. Select first_name, incentive amount from employee and incentives table for those employees who have incentives and incentive amount greater than 3000
                        Ans.
                        SELECT e.FirstName, i.IncentiveAmount
                        FROM Employees AS e INNER JOIN Incentives AS i
                        ON e.EmployeeID = i.EmpRefID
                        WHERE i.IncentiveAmount>3000

                        Q 3. Select first_name, incentive amount from employee and incentives table for all employees even if they didn�t get incentives.
                        Ans.
                        SELECT e.FirstName, i.IncentiveAmount
                        FROM Employees AS e LEFT OUTER JOIN Incentives AS i
                        ON e.EmployeeID = i.EmpRefID

                        Q 4. Select EmployeeName, ManagerName from the employee table.
                        Ans.
                        SELECT e1.FirstName AS 'EmployeeName', e2.FirstName AS 'ManagerName'
                        FROM Employees AS e1 JOIN Employees AS e2
                        ON e1.ManagerID = e2.EmployeeID

                        Q 5. Select first_name, incentive amount from employee and incentives table for all employees even if they didn�t get incentives and set incentive
                        amount as 0 for those employees who didn�t get incentives.
                        Ans.
                        SELECT e.FirstName, ISNULL(i.IncentiveAmount, 0)
                        FROM Employees AS e LEFT OUTER JOIN Incentives AS i
                        ON e.EmployeeID = i.EmpRefID
                        
                    </pre>


                    <h4>Car Company Assignment Tasks</h4>
                    <pre>
                        USE Day2DB

                        CREATE TABLE Cars(
                            CarId INT,
                            VIN INT CONSTRAINT pkCarVIN PRIMARY KEY,
                            Make VARCHAR(25),
                            Model VARCHAR(25),
                            Year DATE,
                            Mileage INT,
                            AskPrice MONEY,
                            InvoicePrice MONEY
                        )

                        CREATE TABLE Dealerships(
                            DealershipId INT CONSTRAINT pkDealershipId PRIMARY KEY,
                            Name VARCHAR(50),
                            Address VARCHAR(50),
                            City VARCHAR(50),
                            State VARCHAR(50)
                        )

                        CREATE TABLE SalesPersons(
                            SalesPersonId INT CONSTRAINT pkSalesPersonId PRIMARY KEY,
                            Name VARCHAR(50)
                        )

                        CREATE TABLE Customers(
                            CustomerId INT CONSTRAINT pkCustomerId PRIMARY KEY,
                            Name VARCHAR(50),
                            Address VARCHAR(50),
                            City VARCHAR(50),
                            State VARCHAR(50)
                        )

                        CREATE TABLE ReportsTos(
                            ReportsToId INT CONSTRAINT pkReportsToId PRIMARY KEY,
                            SalesPersonId INT CONSTRAINT fkSalesPersonId FOREIGN KEY REFERENCES SalesPersons(SalesPersonId),
                            ManagingSalesPersonId INT CONSTRAINT fkManagingSalesPersonId FOREIGN KEY REFERENCES SalesPersons(SalesPersonId)
                        )

                        CREATE TABLE WorksAt(
                            WorksAtId INT CONSTRAINT pkWorksAtId PRIMARY KEY,
                            SalesPersonId INT CONSTRAINT fkWorksAtSalesPersonId FOREIGN KEY REFERENCES SalesPersons(SalesPersonId),
                            DealershipId INT CONSTRAINT fkWorksAtDealershipId FOREIGN KEY REFERENCES Dealerships(DealershipId),
                            MonthWorked VARCHAR(25),
                            BaseSalaryForMonth MONEY
                        )

                        CREATE TABLE Inventorys(
                            InventoryId INT CONSTRAINT pkInventoryId PRIMARY KEY,
                            VIN INT CONSTRAINT fkInventoryVIN FOREIGN KEY REFERENCES Cars(VIN),
                            DealershipId INT CONSTRAINT fkInventoryDealershipId FOREIGN KEY REFERENCES Dealerships(DealershipId)
                        )

                        CREATE TABLE Sales(
                            SaleId INT CONSTRAINT pkSalesId PRIMARY KEY,
                            VIN INT CONSTRAINT fkSalesVIN FOREIGN KEY REFERENCES Cars(VIN),
                            CustomerId INT CONSTRAINT fkSalesCustomerId FOREIGN KEY REFERENCES Customers(CustomerId),
                            SalesPersonId INT CONSTRAINT fkSalesSalesPersonId FOREIGN KEY REFERENCES SalesPersons(SalesPersonId),
                            DealershipId INT CONSTRAINT fkSalesDealershipId FOREIGN KEY REFERENCES Dealerships(DealershipId),
                            SalePrice MONEY,
                            SaleDate DATE
                        )

                        SELECT * FROM Cars

                        SELECT * FROM Dealerships

                        SELECT * FROM SalesPersons

                        SELECT * FROM Customers

                        SELECT * FROM ReportsTos

                        SELECT * FROM WorksAt

                        SELECT * FROM Inventorys

                        SELECT * FROM Sales

                        Q 1. Find the names of all salespeople who have ever worked for the company at any dealership.
                        Ans.
                        SELECT DISTINCT s.Name
                        FROM SalesPersons AS s JOIN WorksAt AS w
                        ON s.SalesPersonId = w.SalesPersonId

                        Q 2. List the Name, Street Address, and City of each customer who lives in Ahmedabad.
                        Ans.
                        SELECT Name, Address, City
                        FROM Customers
                        WHERE City = 'Ahmedabad'

                        Q 3. List the VIN, make, model, year, and mileage of all cars in the inventory of the dealership named "Hero Honda Car World".
                        Ans.
                        SELECT c.VIN, c.Make, c.Model, c.Year, c.Mileage
                        FROM Cars AS c JOIN Inventorys AS i
                        ON c.VIN = i.VIN JOIN Dealerships AS d
                        ON i.DealershipId = d.DealershipId
                        WHERE d.Name = 'Hero Honda Car World'

                        Q 4. List names of all customers who have ever bought cars from the dealership named "Concept Hyundai".
                        Ans.
                        SELECT c.Name
                        FROM Customers AS c JOIN Sales AS s
                        ON c.CustomerId = s.CustomerId JOIN Dealerships AS d
                        ON s.DealershipId = d.DealershipId
                        WHERE d.Name = 'Concept Hyundai'

                        Q 5. For each car in the inventory of any dealership, list the VIN, make, model, and year of the car, along with the name, city, and state of the
                        dealership whose inventory contains the car.
                        Ans.
                        SELECT c.VIN, c.Make, c.Model, c.Year, d.Name, d.City, d.State
                        FROM Cars AS c JOIN Inventorys AS i
                        ON c.VIN = i.VIN JOIN Dealerships AS d
                        ON i.DealershipId = d.DealershipId

                        Q 6. Find the names of all salespeople who are managed by a salesperson named "Adam Smith".
                        Ans.
                        SELECT s1.Name
                        FROM SalesPersons AS s1 JOIN ReportsTos AS r
                        ON s1.SalesPersonId = r.SalesPersonId JOIN SalesPersons AS s2
                        ON r.ManagingSalesPersonId = s2.SalesPersonId
                        WHERE s2.Name = 'Adam Smith'

                        Q 7. Find the names of all salespeople who do not have a manager.
                        Ans.
                        SELECT s.Name
                        FROM SalesPersons AS s LEFT OUTER JOIN ReportsTos AS r
                        ON s.SalesPersonId = r.SalesPersonId
                        WHERE r.ManagingSalesPersonId IS NULL

                        Q 8. Find the total number of dealerships.
                        Ans.
                        SELECT COUNT(DealershipId) AS 'TotalDealerships'
                        FROM Dealerships

                        Q 9. List the VIN, year, and mileage of all "Toyota Camrys" in the inventory of the dealership named "Toyota Performance".
                        (Note that a "Toyota Camry" is indicated by the make being "Toyota" and the model being "Camry".)
                        Ans.
                        SELECT c.VIN, c.Year, c.Mileage
                        FROM Cars AS c JOIN Inventorys AS i
                        ON c.VIN = i.VIN JOIN Dealerships AS d
                        ON i.DealershipId = d.DealershipId
                        WHERE d.Name = 'Toyota Performance' AND c.Make = 'Toyota' AND c.Model = 'Camrys'

                        Q 10. Find the name of all customers who bought a car at a dealership located in a state other than the state in which they live.
                        Ans.
                        SELECT c.Name
                        FROM Customers AS c JOIN Sales AS s
                        ON c.CustomerId = s.CustomerId JOIN Dealerships AS d
                        ON s.DealershipId = d.DealershipId
                        WHERE c.State <> d.State

                        Q 11. Find the name of the salesperson that made the largest base salary working at the dealership named "Ferrari Sales" during January 2010.
                        Ans.
                        SELECT TOP(1) s.Name
                        FROM SalesPersons AS s JOIN WorksAt AS w
                        ON s.SalesPersonId = w.SalesPersonId JOIN Dealerships AS d
                        ON w.DealershipId = d.DealershipId JOIN Sales AS sale
                        ON d.DealershipId = sale.DealershipId
                        WHERE d.Name = 'Ferrari Sales' AND YEAR(sale.SaleDate) = 2010 AND DATENAME(MM, sale.SaleDate) = 'January'
                        ORDER BY w.BaseSalaryForMonth DESC

                        Q 12. List the name, street address, city, and state of any customer who has bought more than two cars from all dealerships combined since January 1, 2010.
                        Ans.
                        SELECT c.Name, c.Address, c.City, c.State
                        FROM (
                            SELECT DENSE_RANK() OVER (PARTITION BY CustomerId ORDER BY SaleId ASC) 'dRank', *
                            FROM Sales
                            ) [tblTemp]
                        JOIN Customers AS c
                        ON tblTemp.CustomerId = c.CustomerId
                        WHERE dRank >= 2 AND SaleDate >= '2010-01-01'
                        GROUP BY c.Name, c.Address, c.City, c.State

                        Q 13. List the name, salesperson ID, and total sales amount for each salesperson who has ever sold at least one car. The total sales amount for a
                        salesperson is the sum of the sale prices of all cars ever sold by that salesperson.
                        Ans.
                        SELECT s.SalesPersonId, sp.Name, SUM(s.SalePrice) AS 'TotalSales'
                        FROM SalesPersons AS sp JOIN Sales AS s
                        ON sp.SalesPersonId = s.SalesPersonId
                        GROUP BY s.SalesPersonId, sp.Name
                        HAVING COUNT(s.SalesPersonId) >= 1

                        Q 14. Find the names of all customers who bought cars during 2010 who were also salespeople during 2010. For the purpose of this query, assume
                        that no two people have the same name.
                        Ans.
                        SELECT c.Name
                        FROM Customers AS c JOIN SalesPersons as sp
                        ON c.Name = sp.Name JOIN Sales AS s
                        ON sp.SalesPersonId = s.SalesPersonId
                        WHERE DATEPART(YY, s.SaleDate) = 2010

                        Q 15. Find the name and salesperson ID of the salesperson who sold the most cars for the company at dealerships located in Gujarat
                        between March 1, 2010 and March 31, 2010.
                        Ans.
                        SELECT TOP(1) s.SalesPersonId, sp.Name
                        FROM SalesPersons AS sp JOIN Sales AS s
                        ON sp.SalesPersonId = s.SalesPersonId JOIN Dealerships as d
                        ON d.DealershipId = s.DealershipId
                        WHERE d.State = 'Gujarat' AND s.SaleDate BETWEEN '2010-03-01' AND '2010-03-31'
                        GROUP BY s.SalesPersonId, sp.Name
                        ORDER BY COUNT(s.SalesPersonId) DESC

                        Q 16. Calculate the payroll for the month of March 2010.
                                * The payroll consists of the name, salesperson ID, and gross pay for each salesperson who worked that month.
                                * The gross pay is calculated as the base salary at each dealership employing the salesperson that month, along with the total commission
                                for the salesperson that month.
                                * The total commission for a salesperson in a month is calculated as 5% of the profit made on all cars sold by the salesperson that month.
                                * The profit made on a car is the difference between the sale price and the invoice price of the car. (Assume, that cars are never sold for
                                less than the invoice price.)
                        Ans.
                        SELECT sp.SalesPersonId, sp.Name, SUM(ISNULL(w.BaseSalaryForMonth, 0) + ISNULL(((s.SalePrice-c.InvoicePrice)*5/100), 0)) AS 'GrossPay'
                        FROM SalesPersons AS sp JOIN WorksAt AS w
                        ON sp.SalesPersonId = w.SalesPersonId JOIN Sales AS s
                        ON w.SalesPersonId = s.SalesPersonId JOIN Cars AS c
                        ON s.VIN = c.VIN
                        WHERE DATENAME(MM, s.SaleDate) = 'March' AND DATENAME(YY, s.SaleDate) = 2010
                        GROUP BY sp.salespersonid, sp.name

                    </pre>

                </div>
            </div>
        </div>

        <script src="../../../js/jquery.min.js"></script>
        <script src="../../../js/popper.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            function myFunc() { 
                var sidebarContent = document.getElementById("sidebar"); 
                sidebarContent.classList.toggle("active");
                return false; 
            } 
        </script>
    </body>
</html>